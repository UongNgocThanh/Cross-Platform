const {
  GoogleGenerativeAI,
  HarmCategory,
  HarmBlockThreshold,
} = require("@google/generative-ai");

const apiKey = process.env.EXPO_PUBLIC_GOOGLE_GEMINI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-2.0-flash",
});

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 40,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};

export const chatSession = model.startChat({
  generationConfig,
  history: [
    {
      role: "user",
      parts: [
        {text: "Generate Travel Plan for Location: Da Nang, Vietnam for 3 Days and 2 Night for A Couple with a Moderate budget with a Flight details, Flight Price with Booking url, Hotels options list with HotelName, Hotel address, Price, hotel image url, geo coordinates, rating, descriptions and Places to visit nearby with placeName, Place Details, Place Image Url, Geo Coordinates, ticket Pricing, Time to travel each of the location for 3 days and 2 night with each day plan with best time to visit in JSON format."},
      ],
    },
    {
      role: "model",
      parts: [
        {text: "```json\n{\n  \"tripDetails\": {\n    \"location\": \"Da Nang, Vietnam\",\n    \"duration\": \"3 Days, 2 Nights\",\n    \"budget\": \"Moderate\",\n    \"travelers\": \"Couple\"\n  },\n  \"flightDetails\": {\n    \"departureCity\": \"Your Departure City (e.g., Hanoi)\",\n    \"arrivalCity\": \"Da Nang (DAD)\",\n    \"departureDate\": \"YYYY-MM-DD\",\n    \"returnDate\": \"YYYY-MM-DD\",\n    \"estimatedFlightPrice\": {\n      \"currency\": \"USD\",\n      \"amount\": 150\n    },\n    \"exampleBookingUrl\": \"https://www.skyscanner.com/\",\n    \"note\": \"Flight prices vary significantly. Use Skyscanner, Google Flights, or Kayak to find the best deals from your departure city.  Book in advance for better prices.\"\n  },\n  \"hotelOptions\": [\n    {\n      \"hotelName\": \"Minh Toan Galaxy Hotel\",\n      \"hotelAddress\": \"306 2 Tháng 9, Hoà Cường Bắc, Hải Châu, Đà Nẵng 550000, Vietnam\",\n      \"price\": {\n        \"currency\": \"USD\",\n        \"perNight\": 40\n      },\n      \"hotelImageUrl\": \"https://example.com/minhtoan_galaxy.jpg\",\n      \"geoCoordinates\": {\n        \"latitude\": 16.0476,\n        \"longitude\": 108.2214\n      },\n      \"rating\": 4.5,\n      \"description\": \"A modern hotel with a rooftop pool and excellent views of the city and Han River. Close to the Dragon Bridge and other attractions. Offers comfortable rooms and good service.\",\n      \"amenities\": [\"Rooftop pool\", \"Restaurant\", \"Bar\", \"Free WiFi\", \"Airport shuttle\"]\n    },\n    {\n      \"hotelName\": \"Memory Hostel\",\n      \"hotelAddress\": \"03 Trần Quốc Toản, Hải Châu 1, Hải Châu, Đà Nẵng 550000, Vietnam\",\n      \"price\": {\n        \"currency\": \"USD\",\n        \"perNight\": 20\n      },\n      \"hotelImageUrl\": \"https://example.com/memory_hostel.jpg\",\n      \"geoCoordinates\": {\n        \"latitude\": 16.0678,\n        \"longitude\": 108.2210\n      },\n      \"rating\": 4.2,\n      \"description\": \"A budget-friendly hostel with a social atmosphere, perfect for meeting other travelers.  Clean and comfortable dorms and private rooms available. Central location.\",\n      \"amenities\": [\"Free WiFi\", \"Common area\", \"Breakfast available\", \"Laundry service\"]\n    },\n    {\n      \"hotelName\": \"HAIAN Riverfront Hotel Da Nang\",\n      \"hotelAddress\": \"172 Bạch Đằng, Hải Châu 1, Hải Châu, Đà Nẵng 550000, Vietnam\",\n      \"price\": {\n        \"currency\": \"USD\",\n        \"perNight\": 60\n      },\n      \"hotelImageUrl\": \"https://example.com/haian_riverfront.jpg\",\n      \"geoCoordinates\": {\n        \"latitude\": 16.0697,\n        \"longitude\": 108.2234\n      },\n      \"rating\": 4.6,\n      \"description\": \"Stylish hotel on the Han Riverfront.  Excellent location, stunning views, and great amenities. Slightly more upscale but still within a moderate budget.\",\n      \"amenities\": [\"River views\", \"Pool\", \"Restaurant\", \"Bar\", \"Free WiFi\", \"Gym\"]\n    }\n  ],\n  \"dayPlans\": [\n    {\n      \"day\": 1,\n      \"theme\": \"City Exploration & River Views\",\n      \"activities\": [\n        {\n          \"placeName\": \"Dragon Bridge\",\n          \"placeDetails\": \"Iconic bridge that breathes fire and water on weekend evenings (9 PM).  Walk along the bridge or watch the show from the riverbank.\",\n          \"placeImageUrl\": \"https://example.com/dragon_bridge.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0614,\n            \"longitude\": 108.2306\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 0\n          },\n          \"timeToTravel\": \"5-10 minutes from city center hotels\",\n          \"bestTimeToVisit\": \"Evening (for the fire/water show on weekends)\"\n        },\n        {\n          \"placeName\": \"Da Nang Cathedral\",\n          \"placeDetails\": \"A beautiful pink cathedral built during the French colonial period. A landmark in the city center.\",\n          \"placeImageUrl\": \"https://example.com/danang_cathedral.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0664,\n            \"longitude\": 108.2214\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 0\n          },\n          \"timeToTravel\": \"Walking distance from many hotels in the city center\",\n          \"bestTimeToVisit\": \"Morning (to avoid crowds)\"\n        },\n        {\n          \"placeName\": \"Han Market\",\n          \"placeDetails\": \"A bustling local market where you can find everything from souvenirs to local food and clothing. Bargaining is expected.\",\n          \"placeImageUrl\": \"https://example.com/han_market.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0692,\n            \"longitude\": 108.2208\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 0\n          },\n          \"timeToTravel\": \"Walking distance from Da Nang Cathedral\",\n          \"bestTimeToVisit\": \"Morning (to see the market at its most active)\"\n        },\n         {\n          \"placeName\": \"Han River Cruise\",\n          \"placeDetails\": \"Enjoy a scenic cruise along the Han River, especially beautiful at night when the bridges are lit up.\",\n          \"placeImageUrl\": \"https://example.com/han_river_cruise.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0700,\n            \"longitude\": 108.2230\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 10\n          },\n          \"timeToTravel\": \"Walking distance from the city center\",\n          \"bestTimeToVisit\": \"Evening (for the lights)\"\n        }\n      ]\n    },\n    {\n      \"day\": 2,\n      \"theme\": \"Beach Relaxation & Mountain Views\",\n      \"activities\": [\n        {\n          \"placeName\": \"My Khe Beach\",\n          \"placeDetails\": \"One of the most famous beaches in Vietnam, known for its white sand and clear water. Relax, swim, or try some water sports.\",\n          \"placeImageUrl\": \"https://example.com/my_khe_beach.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0561,\n            \"longitude\": 108.2547\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 0\n          },\n          \"timeToTravel\": \"15-20 minutes by taxi from the city center\",\n          \"bestTimeToVisit\": \"Morning or late afternoon (to avoid the midday heat)\"\n        },\n        {\n          \"placeName\": \"Marble Mountains\",\n          \"placeDetails\": \"A cluster of five marble and limestone hills with caves, temples, and stunning views. Explore the caves and enjoy the panoramic scenery.\",\n          \"placeImageUrl\": \"https://example.com/marble_mountains.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 15.9776,\n            \"longitude\": 108.2583\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 2\n          },\n          \"timeToTravel\": \"20-30 minutes by taxi from My Khe Beach\",\n          \"bestTimeToVisit\": \"Morning (to avoid the crowds and heat)\",\n          \"note\": \"Wear comfortable shoes as there is a lot of walking and climbing involved.\"\n        },\n        {\n          \"placeName\": \"Am Phu Cave (Inside Marble Mountains)\",\n          \"placeDetails\": \"Explore the hell cave and heaven cave inside marble mountain.\",\n          \"placeImageUrl\": \"https://example.com/am_phu_cave.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 15.9776,\n            \"longitude\": 108.2583\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 1\n          },\n          \"timeToTravel\": \"Inside Marble Mountain\",\n          \"bestTimeToVisit\": \"Morning (to avoid the crowds and heat)\"\n        }\n      ]\n    },\n    {\n      \"day\": 3,\n      \"theme\": \"Cultural Immersion & Departure\",\n      \"activities\": [\n        {\n          \"placeName\": \"Linh Ung Pagoda (Son Tra Peninsula)\",\n          \"placeDetails\": \"A beautiful pagoda with a giant Lady Buddha statue overlooking the sea.  Enjoy stunning views of the coastline.\",\n          \"placeImageUrl\": \"https://example.com/linh_ung_pagoda.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0995,\n            \"longitude\": 108.2695\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 0\n          },\n          \"timeToTravel\": \"30-40 minutes by taxi from the city center\",\n          \"bestTimeToVisit\": \"Morning (for the best light and fewer crowds)\"\n        },\n        {\n          \"placeName\": \"Son Tra Mountain (Monkey Mountain)\",\n          \"placeDetails\": \"Explore the lush rainforest of Son Tra Peninsula. You might spot monkeys! Offers panoramic views of Da Nang and the surrounding area.\",\n          \"placeImageUrl\": \"https://example.com/son_tra_mountain.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.1167,\n            \"longitude\": 108.2667\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 0\n          },\n          \"timeToTravel\": \"Accessible from Linh Ung Pagoda\",\n          \"bestTimeToVisit\": \"Morning or afternoon\"\n        },\n        {\n          \"placeName\": \"Da Nang Museum of Cham Sculpture\",\n          \"placeDetails\": \"Houses a large collection of Cham artifacts, showcasing the rich history of the Cham civilization that once thrived in this region.\",\n          \"placeImageUrl\": \"https://example.com/cham_museum.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0622,\n            \"longitude\": 108.2244\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 2\n          },\n          \"timeToTravel\": \"10-15 minutes by taxi from the city center\",\n          \"bestTimeToVisit\": \"Anytime\"\n        },\n        {\n          \"placeName\": \"Departure\",\n          \"placeDetails\": \"Head to Da Nang International Airport (DAD) for your flight home.\",\n          \"placeImageUrl\": \"https://example.com/danang_airport.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 16.0439,\n            \"longitude\": 108.2014\n          },\n          \"ticketPricing\": {\n            \"currency\": \"USD\",\n            \"amount\": 0\n          },\n          \"timeToTravel\": \"15-20 minutes by taxi from the city center\",\n          \"bestTimeToVisit\": \"According to your flight schedule\"\n        }\n      ]\n    }\n  ],\n  \"foodRecommendations\": [\n    {\n      \"dish\": \"Mi Quang\",\n      \"description\": \"A signature Da Nang noodle dish with turmeric-infused broth, pork, shrimp, peanuts, and rice crackers.\",\n      \"restaurantSuggestion\": \"Mi Quang Ba Vi (various locations)\"\n    },\n    {\n      \"dish\": \"Banh Xeo\",\n      \"description\": \"Crispy Vietnamese pancakes filled with shrimp, pork, and bean sprouts. Served with fresh herbs and dipping sauce.\",\n      \"restaurantSuggestion\": \"Banh Xeo Ba Duong (Hoang Dieu Street)\"\n    },\n    {\n      \"dish\": \"Cao Lau\",\n      \"description\": \"A Hoi An specialty (but also available in Da Nang) with thick noodles, pork, greens, and crispy croutons.\",\n      \"restaurantSuggestion\": \"Try at local restaurants in the city center.\"\n    },\n    {\n      \"dish\": \"Fresh Seafood\",\n      \"description\": \"Da Nang is a coastal city, so fresh seafood is abundant and delicious.  Try grilled fish, prawns, or squid.\",\n      \"restaurantSuggestion\": \"Seafood restaurants along the beach (e.g., My Khe Beach area)\"\n    }\n  ],\n  \"notes\": [\n    \"Remember to bargain at markets.\",\n    \"Taxis and Grab are readily available and affordable.\",\n    \"Learn a few basic Vietnamese phrases.\",\n    \"Stay hydrated, especially in the heat.\",\n    \"Be aware of your belongings in crowded areas.\",\n    \"Check visa requirements for Vietnam before you travel.\",\n    \"Image URLs are placeholders.  Replace them with actual image URLs.\",\n     \"Flight prices and hotel rates are estimates and can vary.\"\n  ]\n}\n```\n\n"},
      ],
    },
  ],
});
